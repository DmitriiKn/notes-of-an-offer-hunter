# –ò–¥–µ–∞–ª—å–Ω—ã–π –ø—Ä–æ–º—Ç –¥–ª—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –º–µ—Ç–æ–¥–∞: –∏–∑–º–µ–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ —Å—á–µ—Ç–∞

–ü—Ä–æ–º—Ç –¥–ª—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –º–µ—Ç–æ–¥–∞ ‚Äî —ç—Ç–æ **—Ñ–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ**, –∫–æ—Ç–æ—Ä–æ–µ –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –≤—Å—é –∫–æ–Ω—Ç–µ–∫—Å—Ç—É–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è. –í–æ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥.

## üéØ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏–¥–µ–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ–º—Ç–∞ (–ø–æ —á–∞—Å—Ç—è–º)

### –ß–∞—Å—Ç—å 1: –ë–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç –∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞
**–¶–µ–ª—å:** –î–∞—Ç—å –ò–ò –ø–æ–Ω–∏–º–∞–Ω–∏–µ "–∑–∞—á–µ–º" –∏ "–ø–æ—á–µ–º—É".
```
–ë–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç:
- –ú–µ—Ç–æ–¥ —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç—å—é –º–æ–¥—É–ª—è "–û–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ —Å—á–µ—Ç–∞–º" –±–∞–Ω–∫–æ–≤—Å–∫–æ–π —Å–∏—Å—Ç–µ–º—ã
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ —Å—á–µ—Ç–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏: –ø—Ä–æ–≤–µ–¥–µ–Ω–∏–∏ –ø–ª–∞—Ç–µ–∂–∞, –Ω–∞—á–∏—Å–ª–µ–Ω–∏–∏ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤, –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ –ø–æ —Ä–µ—à–µ–Ω–∏—é —Å–ª—É–∂–±—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏
- –û—Å–Ω–æ–≤–Ω–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞: –æ–±–µ—Å–ø–µ—á–∏—Ç—å –∞—Ç–æ–º–∞—Ä–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ —Å —Å–æ–±–ª—é–¥–µ–Ω–∏–µ–º –≤—Å–µ—Ö —Ä–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π

–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞ (–ø–æ—á–µ–º—É –Ω—É–∂–µ–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥):
- –ù–∞—Ä—É—à–µ–Ω –ø—Ä–∏–Ω—Ü–∏–ø –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (SRP): –º–µ—Ç–æ–¥ –¥–µ–ª–∞–µ—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∞ edge-cases –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ù–µ—Ç unit-—Ç–µ—Å—Ç–æ–≤, –ø–æ–∫—Ä—ã–≤–∞—é—â–∏—Ö –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
```

### –ß–∞—Å—Ç—å 2: –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (–∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ–¥–∞)
**–¶–µ–ª—å:** –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –ò–ò –ø–æ–ª–Ω—ã–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç.
```java
// –ü–û–õ–ù–ê–Ø –°–ò–ì–ù–ê–¢–£–†–ê –º–µ—Ç–æ–¥–∞ –∏ –æ–∫—Ä—É–∂–∞—é—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
@Service
@Transactional
public class AccountBalanceService {
    private final AccountRepository accountRepository;
    private final TransactionLogService logService;
    private final NotificationService notificationService;
    
    /**
     * –¢–ï–ö–£–©–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø (—Ç—Ä–µ–±—É–µ—Ç —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞)
     * –ò–∑–º–µ–Ω—è–µ—Ç –±–∞–ª–∞–Ω—Å —Å—á–µ—Ç–∞ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ–º
     * @param accountId - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å—á–µ—Ç–∞ (—Ñ–æ—Ä–º–∞—Ç: "ACC-XXXX-YYYY")
     * @param amount - —Å—É–º–º–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è (–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è, –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è –¥–ª—è —Å–ø–∏—Å–∞–Ω–∏—è)
     * @param operationType - —Ç–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏: "PAYMENT", "TRANSFER", "CORRECTION", "INTEREST"
     * @param reference - —Å—Å—ã–ª–∫–∞ –Ω–∞ –∏—Å—Ö–æ–¥–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é (–º–æ–∂–µ—Ç –±—ã—Ç—å null)
     * @return –Ω–æ–≤—ã–π –±–∞–ª–∞–Ω—Å —Å—á–µ—Ç–∞
     * @throws InsufficientFundsException –µ—Å–ª–∏ –±–∞–ª–∞–Ω—Å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –ø–æ—Å–ª–µ —Å–ø–∏—Å–∞–Ω–∏—è
     * @throws AccountNotFoundException –µ—Å–ª–∏ —Å—á–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω
     */
    public BigDecimal changeBalance(Long accountId, BigDecimal amount, 
                                   String operationType, String reference) {
        // –í–ê–ñ–ù–û: –í–µ—Å—å —Ç–µ–∫—É—â–∏–π –∫–æ–¥ –º–µ—Ç–æ–¥–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–¥–µ—Å—å
        Account account = accountRepository.findById(accountId)
            .orElseThrow(() -> new AccountNotFoundException(accountId));
        
        // –í–∞–ª–∏–¥–∞—Ü–∏—è
        if (amount == null || amount.compareTo(BigDecimal.ZERO) == 0) {
            throw new InvalidAmountException("Amount cannot be null or zero");
        }
        
        BigDecimal newBalance = account.getBalance().add(amount);
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å (—Ç–æ–ª—å–∫–æ –¥–ª—è —Å–ø–∏—Å–∞–Ω–∏–π)
        if (newBalance.compareTo(BigDecimal.ZERO) < 0) {
            throw new InsufficientFundsException(accountId, amount);
        }
        
        account.setBalance(newBalance);
        accountRepository.save(account);
        
        // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
        logService.logTransaction(accountId, amount, operationType, reference);
        
        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ (–µ—Å–ª–∏ —Å—É–º–º–∞ > 100000)
        if (amount.abs().compareTo(new BigDecimal("100000")) > 0) {
            notificationService.notifyLargeTransaction(accountId, amount);
        }
        
        return newBalance;
    }
}
```

### –ß–∞—Å—Ç—å 3: –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É
**–¶–µ–ª—å:** –ß–µ—Ç–∫–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —á—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ.
```
–¶–ï–õ–ò –†–ï–§–ê–ö–¢–û–†–ò–ù–ì–ê:
1. –†–∞–∑–¥–µ–ª–∏—Ç—å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å: –≤—ã–¥–µ–ª–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –∏ side-—ç—Ñ—Ñ–µ–∫—Ç—ã
2. –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
3. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –∞—É–¥–∏—Ç–∞ –¥–ª—è —Ä–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
4. –£–ª—É—á—à–∏—Ç—å —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å

–ö–û–ù–ö–†–ï–¢–ù–´–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø:
- –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å-–≤–∞–ª–∏–¥–∞—Ç–æ—Ä AccountBalanceValidator
- –í—ã–Ω–µ—Å—Ç–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å —Å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º "Observer"
- –î–æ–±–∞–≤–∏—Ç—å –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—É—é –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è lost updates
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω "Command" –¥–ª—è –æ—Ç–º–µ–Ω—ã –æ–ø–µ—Ä–∞—Ü–∏–π (–∫–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏–µ –ø—Ä–æ–≤–æ–¥–∫–∏)
- –ù–µ –∏–∑–º–µ–Ω—è—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π API –º–µ—Ç–æ–¥–∞ (—Å–∏–≥–Ω–∞—Ç—É—Ä–∞ –¥–æ–ª–∂–Ω–∞ –æ—Å—Ç–∞—Ç—å—Å—è –ø—Ä–µ–∂–Ω–µ–π)
```

### –ß–∞—Å—Ç—å 4: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ edge-cases
**–¶–µ–ª—å:** –ü—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç—å –æ —Å–∫—Ä—ã—Ç—ã—Ö —Ä–∏—Å–∫–∞—Ö.
```
–¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø:
- –†–∞–±–æ—Ç–∞–µ–º —Å Java 17, Spring Boot 3.x, JPA/Hibernate
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö: PostgreSQL 15, —É—Ä–æ–≤–µ–Ω—å –∏–∑–æ–ª—è—Ü–∏–∏ READ_COMMITTED
- –ú–µ—Ç–æ–¥ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ @Transactional –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–µ—Ç–æ–¥–∞ –¥–æ–ª–∂–Ω–æ –æ—Å—Ç–∞—Ç—å—Å—è < 100ms –¥–ª—è 99% –≤—ã–∑–æ–≤–æ–≤

–ë–ò–ó–ù–ï–°-–û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø:
1. –ë–∞–ª–∞–Ω—Å –Ω–µ –º–æ–∂–µ—Ç —É–π—Ç–∏ –≤ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–∫—Ä–æ–º–µ –æ–≤–µ—Ä–¥—Ä–∞—Ñ—Ç–Ω—ã—Ö —Å—á–µ—Ç–æ–≤)
2. –î–ª—è —Å—á–µ—Ç–æ–≤ —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –ª–∏—Ü –ª–∏–º–∏—Ç –Ω–∞ –æ–¥–Ω—É –æ–ø–µ—Ä–∞—Ü–∏—é - 10,000,000 RUB
3. –û–ø–µ—Ä–∞—Ü–∏–∏ –≤ –≤–∞–ª—é—Ç–µ —Ç—Ä–µ–±—É—é—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –ø–æ –∫—É—Ä—Å—É –¶–ë –Ω–∞ –º–æ–º–µ–Ω—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏
4. –î–ª—è —Ç–∏–ø–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏ "CORRECTION" —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–≤—É–∫—Ä–∞—Ç–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (–æ—Å–Ω–æ–≤–Ω–æ–µ + –∞—É–¥–∏—Ç)

EDGE-CASES –î–õ–Ø –û–ë–†–ê–ë–û–¢–ö–ò:
1. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞ –æ–¥–∏–Ω —Å—á–µ—Ç (–∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å)
2. amount = null –∏–ª–∏ amount = 0
3. accountId –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ account –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (status = "FROZEN")
4. –û–ø–µ—Ä–∞—Ü–∏—è –≤ –Ω–µ—Ä–∞–±–æ—á–µ–µ –≤—Ä–µ–º—è (–ø–æ—Å–ª–µ 20:00 –ø–æ –ú–°–ö)
5. –°—É–º–º–∞ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –¥–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç –ø–æ —Å—á–µ—Ç—É
6. –ò–∑–º–µ–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –∑–∞–∫—Ä—ã—Ç–æ–≥–æ —Å—á–µ—Ç–∞ (status = "CLOSED")
7. –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ BigDecimal (–æ—á–µ–Ω—å –±–æ–ª—å—à–∏–µ —Å—É–º–º—ã)
8. –û—Ç–∫–∞—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
9. –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—ã–∑–æ–≤ —Å —Ç–µ–º–∏ –∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ (–∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å)
```

### –ß–∞—Å—Ç—å 5: –ü—Ä–∏–º–µ—Ä—ã —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
**–¶–µ–ª—å:** –ó–∞–¥–∞—Ç—å –æ–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ.
```java
// –¢–ï–°–¢–û–í–´–ï –°–¶–ï–ù–ê–†–ò–ò, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞:
@Test
public void testPositiveDeposit() {
    // –ò—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: —Å—á–µ—Ç ACC-001 —Å –±–∞–ª–∞–Ω—Å–æ–º 1000
    BigDecimal result = service.changeBalance(accountId, 
        new BigDecimal("500.50"), "DEPOSIT", "REF-123");
    assertThat(result).isEqualTo(new BigDecimal("1500.50"));
}

@Test
public void testInsufficientFunds() {
    // –ò—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: —Å—á–µ—Ç ACC-002 —Å –±–∞–ª–∞–Ω—Å–æ–º 100
    assertThrows(InsufficientFundsException.class, () -> {
        service.changeBalance(accountId, 
            new BigDecimal("-200.00"), "PAYMENT", "REF-456");
    });
    // –ë–∞–ª–∞–Ω—Å –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞—Ç—å—Å—è 100
}

@Test
public void testConcurrentOperations() {
    // –î–≤–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –≤—ã–∑–æ–≤–∞ +500 –∏ -300
    // –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, –±–∞–ª–∞–Ω—Å = 1200
}

@Test
public void testAuditLogForCorrection() {
    // –î–ª—è operationType = "CORRECTION"
    // –î–æ–ª–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å—Å—è 2 –∑–∞–ø–∏—Å–∏ –ª–æ–≥–∞: –æ—Å–Ω–æ–≤–Ω–∞—è –∏ –∞—É–¥–∏—Ç-–∑–∞–ø–∏—Å—å
}
```

## üõ°Ô∏è –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –î–û–õ–ñ–ù–´ –±—ã—Ç—å –≤ –ø—Ä–æ–º—Ç–µ

### 1. –†–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
```
–†–ï–ì–£–õ–Ø–¢–û–†–ù–´–ï –¢–†–ï–ë–û–í–ê–ù–ò–Ø (–¶–ë –†–§):
- –ö–∞–∂–¥–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π identifier –¥–ª—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏
- –î–ª—è —Å—É–º–º > 600,000 RUB —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
- –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–π –±–∞–ª–∞–Ω—Å–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ 5 –ª–µ—Ç
- –û–ø–µ—Ä–∞—Ü–∏–∏ –ø–æ—Å–ª–µ 20:00 —Ç—Ä–µ–±—É—é—Ç –ø–æ–º–µ—Ç–∫–∏ "AFTER_HOURS"
```

### 2. –ü–∞—Ç—Ç–µ—Ä–Ω—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
```
–¢–†–ï–ë–û–í–ê–ù–ò–Ø –ö –û–®–ò–ë–ö–ê–ú:
- –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã: –æ—à–∏–±–∫–∞ –≤ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω–µ –¥–æ–ª–∂–Ω–∞ –ø—Ä–µ—Ä—ã–≤–∞—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é
- –ö–æ–º–ø–µ–Ω—Å–∏—Ä—É—é—â–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏: –ø—Ä–∏ –æ—à–∏–±–∫–µ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–∫–∞—Ç–∞
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥: –≤—Å–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ error codes –¥–ª—è –∞–ª–µ—Ä—Ç–∏–Ω–≥–∞
```

### 3. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
```
–ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨:
- 95-–π –ø–µ—Ä—Ü–µ–Ω—Ç–∏–ª—å –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è < 50ms
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 1000 –æ–ø–µ—Ä–∞—Ü–∏–π –≤ —Å–µ–∫—É–Ω–¥—É –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–µ
- –û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤–º–µ—Å—Ç–æ –ø–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–Ω—ã—Ö –≥–¥–µ –≤–æ–∑–º–æ–∂–Ω–æ
```

## üìù –ì–æ—Ç–æ–≤—ã–π —à–∞–±–ª–æ–Ω –ø—Ä–æ–º—Ç–∞ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

## –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç–æ–¥–∞ changeBalance

### 1. –ë–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç
[–û–ø–∏—à–∏—Ç–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞ –≤ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å–∞—Ö –±–∞–Ω–∫–∞]

### 2. –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è
```java
[–ü–æ–ª–Ω—ã–π –∫–æ–¥ –º–µ—Ç–æ–¥–∞ —Å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏]
```

### 3. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É
- –¶–µ–ª—å 1: [–ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è —Ü–µ–ª—å]
- –¶–µ–ª—å 2: [–ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞—è —Ü–µ–ª—å]
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: [–ß—Ç–æ –Ω–µ–ª—å–∑—è –º–µ–Ω—è—Ç—å]

### 4. Edge-cases –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
1. [–°—Ü–µ–Ω–∞—Ä–∏–π 1]
2. [–°—Ü–µ–Ω–∞—Ä–∏–π 2]
3. [–°—Ü–µ–Ω–∞—Ä–∏–π 3]

### 5. –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
```java
[–ö–ª—é—á–µ–≤—ã–µ —Ç–µ—Å—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –ø—Ä–æ—Ö–æ–¥–∏—Ç—å]
```

### 6. –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∏
- –†–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã–µ: [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¶–ë]
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏]
- –ê—É–¥–∏—Ç: [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∞—É–¥–∏—Ç—É]

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ–º—Ç —Å –ò–ò

1. **–ü–æ—ç—Ç–∞–ø–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ**: –ù–µ –ø—Ä–æ—Å–∏—Ç–µ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –≤–µ—Å—å –º–µ—Ç–æ–¥ —Å—Ä–∞–∑—É. –ù–∞—á–Ω–∏—Ç–µ —Å:
   ```
   –®–∞–≥ 1: –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –º–µ—Ç–æ–¥ changeBalance, –Ω–∞–π–¥–∏ –Ω–∞—Ä—É—à–µ–Ω–∏—è SOLID
   –®–∞–≥ 2: –ü—Ä–µ–¥–ª–æ–∂–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–ª–∞—Å—Å–æ–≤ –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞
   –®–∞–≥ 3: –†–µ–∞–ª–∏–∑—É–π —Ç–æ–ª—å–∫–æ –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –∫–ª–∞—Å—Å–µ
   ```

2. **–í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞**: –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –ò–ò:
   ```java
   // –ü—Ä–æ—Å–∏—Ç–µ –æ–±—ä—è—Å–Ω–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:
   "–ü–æ—á–µ–º—É —Ç—ã –≤—ã–±—Ä–∞–ª –æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—É—é –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –≤–º–µ—Å—Ç–æ –ø–µ—Å—Å–∏–º–∏—Å—Ç–∏—á–Ω–æ–π?"
   "–ö–∞–∫ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è edge-case —Å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏?"
   ```

3. **–¢—Ä–µ–±—É–π—Ç–µ —Ç–µ—Å—Ç—ã**: –ö–∞–∂–¥—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –¥–æ–ª–∂–µ–Ω —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞—Ç—å—Å—è —Ç–µ—Å—Ç–∞–º–∏:
   ```
   –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π unit-—Ç–µ—Å—Ç—ã –¥–ª—è:
   1. –û—Å–Ω–æ–≤–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è —Å—á–µ—Ç–∞
   2. –û—à–∏–±–∫–∏ –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–µ —Å—Ä–µ–¥—Å—Ç–≤
   3. –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
   ```

## üíé –ö–ª—é—á–µ–≤–æ–µ –ø—Ä–∞–≤–∏–ª–æ –¥–ª—è –±–∞–Ω–∫–æ–≤—Å–∫–æ–≥–æ –∫–æ–¥–∞

**–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–≥–æ –º–µ—Ç–æ–¥–∞ = —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è + —É–ª—É—á—à–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã + –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤**

–õ—é–±–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ:
1. **–ü—Ä–æ—Ö–æ–¥–∏—Ç—å –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã** (–µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç ‚Äî —Å–æ–∑–¥–∞—Ç—å –ø–µ—Ä–µ–¥ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–æ–º)
2. **–ù–µ –Ω–∞—Ä—É—à–∞—Ç—å —Ä–µ–≥—É–ª—è—Ç–æ—Ä–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è** (–∞—É–¥–∏—Ç, —Ç—Ä–∞—Å—Å–∏—Ä—É–µ–º–æ—Å—Ç—å)
3. **–£–ª—É—á—à–∞—Ç—å –Ω–∞–±–ª—é–¥–∞–µ–º–æ—Å—Ç—å** (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ, –º–µ—Ç—Ä–∏–∫–∏, —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞)

–°–ª–µ–¥—É—é—â–∏–π –ª–æ–≥–∏—á–Ω—ã–π –≤–æ–ø—Ä–æ—Å: "–ö–∞–∫–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ –ø—Ä–∞–∫—Ç–∏–∫–∏ –∫–æ–¥-—Ä–µ–≤—å—é –ø—Ä–∏–º–µ–Ω—è—Ç—å –∫ –∫–æ–¥—É, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –ò–ò –¥–ª—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º? –ù–∞ —á—Ç–æ —Å–º–æ—Ç—Ä–µ—Ç—å –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å?"
